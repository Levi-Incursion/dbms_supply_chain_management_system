SQL statement Queries:-
 
1) Show all Products sold by every Retailer:

SELECT rs.R_GST_Num, p.product_name, p.category, rs.saleprice, rs.quantity from r_sells as rs INNER JOIN products as p ON rs.model_no = p.model_no
order by R_GST_Num;

2)Show the total cost individual manufacturer has to pay for purchasing all the parts given by the supplier

SELECT su.manufacturer_id, SUM (su.Quantity * pa.Unit_Cost) AS total_cost FROM Supplies as su INNER JOIN Parts as pa
ON su.pid = pa.pid group by su.manufacturer_id order by su.Manufacturer_id;

3)Show total profit or loss generated for each retailer

SELECT rt.retailer_name, SUM(rs.quantity * rs.saleprice)  - SUM(rs.quantity * rs.costprice) as sales,costs from r_sells rs JOIN retailer rt ON rs.GST_Num = rt.R_GST_Num;
	

4) Show all products owned by customer with cust_id (77770020).

SELECT rs.invoice_no,cu.cust_name, pd.product_name, pd.category,rs.quantity
FROM products as pd
INNER JOIN r_sells as rs ON pd.model_no = rs.model_no
INNER JOIN customer as cu ON rs.cust_id = cu.cust_id
WHERE cu.cust_id = 77770020;
5) Show all the manufacturer that are distributing to exactly 2 distributors in the shipments

SELECT manufacturer_id, COUNT ( DISTINCT Distributor_id) AS no_of_distributors FROM
shipments group BY manufacturer_id HAVING COUNT( DISTINCT Distributor_id) = 2;

6) List the Names of all products that have been sold by any retailer to any customer in the same city.

SELECT DISTINCT pd.product_name from products as pd
JOIN R_Sells as rs ON pd.model_no = rs.model_no
JOIN Customer as cu ON rs.cust_id = cu.cust_ID
JOIN retailer as re ON rs.r_gst_num = re.r_gst_num
WHERE re.city = cu.city;


7) List the names and contact details of all suppliers those who havenâ€™t sold any parts to manufacturer

SELECT sp.supplier_name, sp.contact_number, sp.contact_email FROM supplier as sp WHERE sp.supplier_id NOT IN (
SELECT DISTINCT su.manufacturer_id FROM supplies as su
)


8) No of customer that are doing payment through UPI

SELECT COUNT(DISTINCT RS.CUST_ID) as no_of_customer FROM R_Sells as rs
INNER JOIN Billing as bl ON rs.invoice_no = bl.invno
WHERE bl.payment_method = 'UPI';
 
9) Show the Total Price to  a customer who has to pay for all the products for that transaction

SELECT ivd.invno, ivd.invdate, cu.cust_name, SUM ( rs.quantity * ( rs.saleprice + (rs.saleprice  * (tax_rate * 0.01)) ) ) as total_price FROM customer as cu  
JOIN R_Sells as rs ON cu.cust_id = rs.cust_id
JOIN Billing as bl on rs.invoice_no = bl.invno  
JOIN invoice_details as ivd on ivd.invno = bl.invno
JOIN products as pd on  bl.model_no = pd.model_no
JOIN tax as tx on pd.model_no = tx.item_code
GROUP BY ivd.invdate, cu.cust_name,ivd.invno
Order by invno asc;

10) List the names and contact information of all distributors who have distributed more than 200 units of any product to wholesalers in Gujarat or Bihar.

SELECT distID, "Name", contact_number, contact_email
FROM distributor
WHERE distID IN (
        SELECT ds.distributor_id
        FROM distributes ds
        JOIN Wholesaler as ws ON ds.W_GST_Num = ws.W_GST_Num
        WHERE ws."State" = 'Gujarat' or ws."State" = 'Bihar'
        GROUP BY ds.distributor_id,ws."State"
        HAVING SUM(ds.quantity) > 200
)

11) List all the Distributors who have sold all the products produced by the manufacturers

SELECT dt.distID, dt."Name"
FROM distributor dt
WHERE NOT EXISTS ( 
	SELECT mf.manufacturer_id
  	FROM manufacturer mf
 WHERE NOT EXISTS(
  SELECT spm.manufacturer_id
  FROM shipments spm, manufacturer mf, distributor dt
  WHERE spm.manufacturer_id = mf.manufacturer_id AND spm.distributor_id = dt.distID
  )
)


12) List all the distributors who have distributed products to all the wholesalers in Ahmedabad.

SELECT DISTINCT d."Name" as Distributor_Name
FROM distributor d
WHERE NOT EXISTS (
    SELECT w.W_GST_Num
    FROM wholesaler w
    WHERE w.city = 'Ahmedabad' AND NOT EXISTS (
        SELECT ds.*
        FROM distributes ds
        WHERE ds.distributor_id = d.distID AND ds.W_GST_Num = w.W_GST_Num
    )
)

13) Calculate the total revenue generated by each retailer in each city for this year

SELECT rt.R_Shop_Name, rt.city, SUM(rs.quantity * rs.saleprice) AS total_revenue FROM retailer rt
JOIN R_Sells rs ON rt.R_GST_Num = rs.R_GST_Num
JOIN invoice_details ivd ON rs.invoice_no = ivd.invno
WHERE EXTRACT(YEAR FROM ivd.invdate) = EXTRACT(YEAR FROM CURRENT_DATE)
GROUP BY rt.R_Shop_Name, rt.city;

14) Show the top 5 wholesalers by revenue;

SELECT wo.wholesaler_name, SUM (ws.quantity * ws.saleprice) as total_revenue from wholesaler as wo  
INNER JOIN w_sells as ws ON wo.w_gst_num = ws.w_gst_num
GROUP BY wo.wholesaler_name
ORDER BY total_revenue DESC
LIMIT 5;  

15). Give the Inventory List for Distributors and Wholesalers

SELECT dt.distID,dt."Name", dc.model_no,pd.product_name, SUM( dc.quantity ) as Total_Quantity FROM D_Contains dc 
INNER JOIN distributor dt ON dt.distID = dc.distributor_id
INNER JOIN products pd ON pd.model_no = dc.model_no
GROUP BY dt.distID,dt."Name", dc.model_no,pd.product_name
ORDER BY dc.model_no ASC;
